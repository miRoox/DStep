Notebook[
 {
  Cell[
   CellGroupData[
    {
     Cell[
      "\:5e26\:6b65\:9aa4\:7684\:521d\:7b49\:51fd\:6570\:6c42\:5bfc",
      "Title"
     ],
     Cell[
      CellGroupData[
       {
        Cell["\:6c42\:5bfc\:89c4\:5219", "Section"],
        Cell["\:57fa\:672c\:89c4\:5219", "Text"],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "baseRules",
              "=",
              RowBox[
               {
                "{",
                "\[IndentingNewLine]",
                RowBox[
                 {
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[{"d", "[", RowBox[{"c_", ",", "x_"}], "]"}],
                      "/;",
                      RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}]
                     }
                    ],
                    "\[RuleDelayed]",
                    "0"
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[{"d", "[", RowBox[{"lf_Plus", ",", "x_"}], "]"}],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "Thread",
                      "[",
                      RowBox[
                       {
                        RowBox[{"d", "[", RowBox[{"lf", ",", "x"}], "]"}],
                        ",",
                        "Plus"
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[{RowBox[{"c_", " ", "f_"}], ",", "x_"}],
                        "]"
                       }
                      ],
                      "/;",
                      RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "c",
                      " ",
                      RowBox[{"d", "[", RowBox[{"f", ",", "x"}], "]"}]
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      "d",
                      "[",
                      RowBox[{RowBox[{"f_", " ", "g_"}], ",", "x_"}],
                      "]"
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      RowBox[
                       {
                        RowBox[{"d", "[", RowBox[{"f", ",", "x"}], "]"}],
                        " ",
                        "g"
                       }
                      ],
                      "+",
                      RowBox[
                       {
                        RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}],
                        " ",
                        "f"
                       }
                      ]
                     }
                    ]
                   }
                  ]
                 }
                ],
                "\[IndentingNewLine]",
                "}"
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[1]:="
        ],
        Cell[
         "\:9ad8\:9636\:89c4\:5219\:ff08\:53cd\:51fd\:6570/\:590d\:5408\:51fd\:6570\:ff09",
         "Text"
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "higherRules",
              "=",
              RowBox[
               {
                "{",
                "\[IndentingNewLine]",
                RowBox[
                 {
                  RowBox[
                   {
                    RowBox[
                     {
                      "HoldPattern",
                      "@",
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {
                            RowBox[{"InverseFunction", "[", "f_", "]"}],
                            "[",
                            "x_",
                            "]"
                           }
                          ],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "1",
                      "/",
                      RowBox[
                       {
                        "dfunc",
                        "[",
                        RowBox[
                         {
                          "f",
                          ",",
                          RowBox[
                           {RowBox[{"InverseFunction", "[", "f", "]"}], "[", "x", "]"}
                          ]
                         }
                        ],
                        "]"
                       }
                      ]
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[{RowBox[{"f_", "[", "g_", "]"}], ",", "x_"}],
                        "]"
                       }
                      ],
                      "/;",
                      RowBox[{"g", "=!=", "x"}]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      RowBox[{"dfunc", "[", RowBox[{"f", ",", "g"}], "]"}],
                      RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}]
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[{"f_", "[", RowBox[{"g_", ",", "c_"}], "]"}],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ],
                      "/;",
                      RowBox[
                       {
                        RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}],
                        "&&",
                        RowBox[{"g", "=!=", "x"}]
                       }
                      ]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      RowBox[
                       {
                        "dfunc",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {RowBox[{"f", "[", RowBox[{"#", ",", "c"}], "]"}], "&"}
                          ],
                          ",",
                          "g"
                         }
                        ],
                        "]"
                       }
                      ],
                      RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}]
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[{"f_", "[", RowBox[{"c_", ",", "g_"}], "]"}],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ],
                      "/;",
                      RowBox[
                       {
                        RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}],
                        "&&",
                        RowBox[{"g", "=!=", "x"}]
                       }
                      ]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      RowBox[
                       {
                        "dfunc",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {RowBox[{"f", "[", RowBox[{"c", ",", "#"}], "]"}], "&"}
                          ],
                          ",",
                          "g"
                         }
                        ],
                        "]"
                       }
                      ],
                      RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}]
                     }
                    ]
                   }
                  ]
                 }
                ],
                "\[IndentingNewLine]",
                "}"
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[2]:="
        ],
        Cell["\:66ff\:6362\:89c4\:5219", "Text"],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "substRules",
              "=",
              RowBox[
               {
                RowBox[
                 {
                  RowBox[{"dfunc", "[", RowBox[{"f_", ",", "g_"}], "]"}],
                  "\[RuleDelayed]",
                  RowBox[
                   {
                    "d",
                    "[",
                    RowBox[{RowBox[{"f", "[", "u", "]"}], ",", "u"}],
                    "]"
                   }
                  ]
                 }
                ],
                "/.",
                RowBox[{"{", RowBox[{"u", "\[Rule]", "g"}], "}"}]
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input"
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "substRules",
              "=",
              RowBox[
               {
                RowBox[{"dfunc", "[", RowBox[{"f_", ",", "g_"}], "]"}],
                "\[RuleDelayed]",
                RowBox[
                 {
                  "Module",
                  "[",
                  RowBox[
                   {
                    RowBox[{"{", "u", "}"}],
                    ",",
                    RowBox[
                     {
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[{RowBox[{"f", "[", "u", "]"}], ",", "u"}],
                        "]"
                       }
                      ],
                      "/.",
                      RowBox[{"{", RowBox[{"u", "\[Rule]", "g"}], "}"}]
                     }
                    ]
                   }
                  ],
                  "]"
                 }
                ]
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input"
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "substRules",
              "=",
              RowBox[
               {
                RowBox[{"dfunc", "[", RowBox[{"f_", ",", "g_"}], "]"}],
                "\[RuleDelayed]",
                RowBox[
                 {
                  "Module",
                  "[",
                  RowBox[
                   {
                    RowBox[{"{", "u", "}"}],
                    ",",
                    RowBox[
                     {
                      RowBox[
                       {
                        "dEval",
                        "[",
                        RowBox[{RowBox[{"f", "[", "u", "]"}], ",", "u"}],
                        "]"
                       }
                      ],
                      "/.",
                      RowBox[{"{", RowBox[{"u", "\[Rule]", "g"}], "}"}]
                     }
                    ]
                   }
                  ],
                  "]"
                 }
                ]
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[3]:="
        ],
        Cell["\:51fd\:6570\:89c4\:5219", "Text"],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "functionRules",
              "=",
              RowBox[
               {
                "{",
                "\[IndentingNewLine]",
                RowBox[
                 {
                  RowBox[
                   {
                    RowBox[
                     {
                      "HoldPattern",
                      "[",
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {
                            "IgnoringInactive",
                            "[",
                            RowBox[{"Exp", "[", "x_", "]"}],
                            "]"
                           }
                          ],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ],
                      "]"
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[{"Exp", "[", "x", "]"}]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      "HoldPattern",
                      "[",
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {
                            "IgnoringInactive",
                            "[",
                            RowBox[{"Log", "[", "x_", "]"}],
                            "]"
                           }
                          ],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ],
                      "]"
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[{"1", "/", "x"}]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      "HoldPattern",
                      "[",
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {
                            "IgnoringInactive",
                            "[",
                            RowBox[{"Sin", "[", "x_", "]"}],
                            "]"
                           }
                          ],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ],
                      "]"
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[{"Cos", "[", "x", "]"}]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      "HoldPattern",
                      "[",
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {
                            "IgnoringInactive",
                            "[",
                            RowBox[{"Cos", "[", "x_", "]"}],
                            "]"
                           }
                          ],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ],
                      "]"
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[{"-", RowBox[{"Sin", "[", "x", "]"}]}]
                   }
                  ]
                 }
                ],
                "\[IndentingNewLine]",
                "}"
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input"
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "functionRules",
              "=",
              RowBox[
               {
                RowBox[
                 {
                  "Table",
                  "[",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "With",
                        "[",
                        RowBox[
                         {
                          RowBox[{"{", RowBox[{"f", "=", "f"}], "}"}],
                          ",",
                          RowBox[
                           {
                            "HoldPattern",
                            "@",
                            RowBox[
                             {
                              "d",
                              "[",
                              RowBox[
                               {
                                RowBox[
                                 {"IgnoringInactive", "@", RowBox[{"f", "[", "x_", "]"}]}
                                ],
                                ",",
                                "x_"
                               }
                              ],
                              "]"
                             }
                            ]
                           }
                          ]
                         }
                        ],
                        "]"
                       }
                      ],
                      "\[Rule]",
                      RowBox[
                       {
                        "D",
                        "[",
                        RowBox[{RowBox[{"f", "[", "x", "]"}], ",", "x"}],
                        "]"
                       }
                      ]
                     }
                    ],
                    ",",
                    "\[IndentingNewLine]",
                    RowBox[
                     {
                      "{",
                      RowBox[
                       {
                        "f",
                        ",",
                        "\[IndentingNewLine]",
                        RowBox[
                         {
                          "{",
                          RowBox[
                           {
                            "Sqrt",
                            ",",
                            "CubeRoot",
                            ",",
                            "RealAbs",
                            ",",
                            "\[IndentingNewLine]",
                            "Exp",
                            ",",
                            "Log",
                            ",",
                            "Log2",
                            ",",
                            "Log10",
                            ",",
                            "\[IndentingNewLine]",
                            "Sin",
                            ",",
                            "Cos",
                            ",",
                            "Tan",
                            ",",
                            "Cot",
                            ",",
                            "Sec",
                            ",",
                            "Csc",
                            ",",
                            "\[IndentingNewLine]",
                            "ArcSin",
                            ",",
                            "ArcCos",
                            ",",
                            "ArcTan",
                            ",",
                            "ArcCot",
                            ",",
                            "ArcSec",
                            ",",
                            "ArcCsc",
                            ",",
                            "\[IndentingNewLine]",
                            "Sinh",
                            ",",
                            "Cosh",
                            ",",
                            "Tanh",
                            ",",
                            "Coth",
                            ",",
                            "Sech",
                            ",",
                            "Csch",
                            ",",
                            "\[IndentingNewLine]",
                            "ArcSinh",
                            ",",
                            "ArcCosh",
                            ",",
                            "ArcTanh",
                            ",",
                            "ArcCoth",
                            ",",
                            "ArcSech",
                            ",",
                            "ArcCsch"
                           }
                          ],
                          "\[IndentingNewLine]",
                          "}"
                         }
                        ]
                       }
                      ],
                      "\[IndentingNewLine]",
                      "}"
                     }
                    ]
                   }
                  ],
                  "]"
                 }
                ],
                "/.",
                RowBox[
                 {"{", RowBox[{"Rule", "\[Rule]", "RuleDelayed"}], "}"}
                ]
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[4]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "functionExtRules",
              "=",
              RowBox[
               {
                "{",
                "\[IndentingNewLine]",
                RowBox[
                 {
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "HoldPattern",
                        "@",
                        RowBox[
                         {
                          "d",
                          "[",
                          RowBox[{RowBox[{"x_", "^", "a_."}], ",", "x_"}],
                          "]"
                         }
                        ]
                       }
                      ],
                      "/;",
                      RowBox[{"FreeQ", "[", RowBox[{"a", ",", "x"}], "]"}]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "a",
                      " ",
                      RowBox[
                       {"x", "^", RowBox[{"(", RowBox[{"a", "-", "1"}], ")"}]}
                      ]
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "HoldPattern",
                        "@",
                        RowBox[
                         {
                          "d",
                          "[",
                          RowBox[{RowBox[{"a_", "^", "x_"}], ",", "x_"}],
                          "]"
                         }
                        ]
                       }
                      ],
                      "/;",
                      RowBox[{"FreeQ", "[", RowBox[{"a", ",", "x"}], "]"}]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      RowBox[{"a", "^", "x"}],
                      " ",
                      RowBox[{"Log", "[", "a", "]"}]
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "HoldPattern",
                        "@",
                        RowBox[
                         {
                          "d",
                          "[",
                          RowBox[
                           {
                            RowBox[
                             {
                              "IgnoringInactive",
                              "@",
                              RowBox[{"Surd", "[", RowBox[{"x_", ",", "n_"}], "]"}]
                             }
                            ],
                            ",",
                            "x_"
                           }
                          ],
                          "]"
                         }
                        ]
                       }
                      ],
                      "/;",
                      RowBox[{"FreeQ", "[", RowBox[{"n", ",", "x"}], "]"}]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "1",
                      "/",
                      RowBox[
                       {
                        "(",
                        RowBox[
                         {
                          "n",
                          " ",
                          RowBox[
                           {
                            RowBox[{"Surd", "[", RowBox[{"x", ",", "n"}], "]"}],
                            "^",
                            RowBox[{"(", RowBox[{"n", "-", "1"}], ")"}]
                           }
                          ]
                         }
                        ],
                        ")"
                       }
                      ]
                     }
                    ]
                   }
                  ]
                 }
                ],
                "\[IndentingNewLine]",
                "}"
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[5]:="
        ],
        Cell["\:53d8\:5f62\:89c4\:5219", "Text"],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "transferRules",
              "=",
              RowBox[
               {
                "{",
                "\[IndentingNewLine]",
                RowBox[
                 {
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "HoldPattern",
                        "@",
                        RowBox[
                         {
                          "d",
                          "[",
                          RowBox[
                           {
                            RowBox[
                             {"IgnoringInactive", "[", RowBox[{"f_", "^", "g_"}], "]"}
                            ],
                            ",",
                            "x_"
                           }
                          ],
                          "]"
                         }
                        ]
                       }
                      ],
                      "/;",
                      RowBox[
                       {
                        "!",
                        RowBox[
                         {
                          "(",
                          RowBox[
                           {
                            RowBox[{"FreeQ", "[", RowBox[{"f", ",", "x"}], "]"}],
                            "||",
                            RowBox[{"FreeQ", "[", RowBox[{"g", ",", "x"}], "]"}]
                           }
                          ],
                          ")"
                         }
                        ]
                       }
                      ]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "d",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          RowBox[{"Inactive", "[", "Exp", "]"}],
                          "[",
                          RowBox[{RowBox[{"Log", "[", "f", "]"}], "g"}],
                          "]"
                         }
                        ],
                        ",",
                        "x"
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      "HoldPattern",
                      "@",
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {
                            "IgnoringInactive",
                            "@",
                            RowBox[{"Log", "[", RowBox[{"f_", ",", "g_"}], "]"}]
                           }
                          ],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "d",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          RowBox[{"Log", "[", "g", "]"}],
                          "/",
                          RowBox[{"Log", "[", "f", "]"}]
                         }
                        ],
                        ",",
                        "x"
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ]
                 }
                ],
                "\[IndentingNewLine]",
                "}"
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[6]:="
        ],
        Cell["\:6574\:5408\:5168\:90e8\:89c4\:5219", "Text"],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "allRules",
              "=",
              RowBox[
               {
                "Flatten",
                "@",
                RowBox[
                 {
                  "{",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    "transferRules",
                    ",",
                    "\[IndentingNewLine]",
                    "baseRules",
                    ",",
                    "\[IndentingNewLine]",
                    "functionRules",
                    ",",
                    "\[IndentingNewLine]",
                    "functionExtRules",
                    ",",
                    "\[IndentingNewLine]",
                    "substRules",
                    ",",
                    "\[IndentingNewLine]",
                    "higherRules"
                   }
                  ],
                  "\[IndentingNewLine]",
                  "}"
                 }
                ]
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[12]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[{"dEval", "[", RowBox[{"f_", ",", "x_"}], "]"}],
            ":=",
            RowBox[
             {
              RowBox[{"d", "[", RowBox[{"f", ",", "x"}], "]"}],
              "//.",
              "allRules"
             }
            ]
           }
          ]
         ],
         "Input",
         CellLabel -> "In[8]:="
        ],
        Cell["\:6d4b\:8bd5", "Text"],
        Cell[
         CellGroupData[
          {
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 RowBox[
                  {
                   RowBox[{"(", RowBox[{"dEval", "\[Equal]", "D"}], ")"}],
                   "[",
                   RowBox[
                    {
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[
                          {
                           "(",
                           RowBox[
                            {
                             RowBox[{"x", "^", RowBox[{"Sin", "[", "x", "]"}]}],
                             "+",
                             RowBox[{"3", "x"}],
                             "+",
                             RowBox[{"ArcTan", "[", "x", "]"}]
                            }
                           ],
                           ")"
                          }
                         ],
                         "^",
                         "2"
                        }
                       ],
                       "/",
                       RowBox[
                        {
                         "(",
                         RowBox[
                          {
                           RowBox[{"x", "^", "4"}],
                           "-",
                           RowBox[
                            {
                             "3",
                             RowBox[
                              {
                               "Surd",
                               "[",
                               RowBox[{RowBox[{"x", "^", "5"}], ",", "3"}],
                               "]"
                              }
                             ],
                             RowBox[{"RealAbs", "@", RowBox[{"Log", "[", "x", "]"}]}]
                            }
                           ],
                           "+",
                           "2"
                          }
                         ],
                         ")"
                        }
                       ]
                      }
                     ],
                     ",",
                     "x"
                    }
                   ],
                   "]"
                  }
                 ],
                 "//",
                 "Through"
                }
               ],
               "//",
               "Simplify"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[9]:="
           ],
           Cell[BoxData["True"], "Output", CellLabel -> "Out[9]="]
          },
          Open
         ]
        ],
        Cell[
         CellGroupData[
          {
           Cell[
            BoxData[
             RowBox[
              {
               "dEval",
               "[",
               RowBox[
                {
                 RowBox[
                  {
                   RowBox[{"Erf", "[", RowBox[{"Sin", "[", "x", "]"}], "]"}],
                   "^",
                   "2"
                  }
                 ],
                 ",",
                 "x"
                }
               ],
               "]"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[10]:="
           ],
           Cell[
            BoxData[
             RowBox[
              {
               "2",
               " ",
               RowBox[{"Cos", "[", "x", "]"}],
               " ",
               RowBox[
                {
                 "d",
                 "[",
                 RowBox[
                  {
                   RowBox[{"Erf", "[", RowBox[{"Sin", "[", "x", "]"}], "]"}],
                   ",",
                   RowBox[{"Sin", "[", "x", "]"}]
                  }
                 ],
                 "]"
                }
               ],
               " ",
               RowBox[{"Erf", "[", RowBox[{"Sin", "[", "x", "]"}], "]"}]
              }
             ]
            ],
            "Output",
            CellLabel -> "Out[10]="
           ]
          },
          Open
         ]
        ],
        Cell["\:5065\:58ee\:6027", "Text"],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "substRules",
              "=",
              RowBox[
               {
                RowBox[{"dfunc", "[", RowBox[{"f_", ",", "g_"}], "]"}],
                "\[RuleDelayed]",
                RowBox[
                 {
                  "Module",
                  "[",
                  RowBox[
                   {
                    RowBox[{"{", "u", "}"}],
                    ",",
                    RowBox[
                     {
                      "With",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          "{",
                          RowBox[
                           {
                            "df",
                            "=",
                            RowBox[
                             {
                              "dEval",
                              "[",
                              RowBox[{RowBox[{"f", "[", "u", "]"}], ",", "u"}],
                              "]"
                             }
                            ]
                           }
                          ],
                          "}"
                         }
                        ],
                        ",",
                        RowBox[
                         {
                          RowBox[
                           {
                            "(",
                            RowBox[
                             {
                              "df",
                              "/.",
                              RowBox[{"{", RowBox[{"u", "\[Rule]", "g"}], "}"}]
                             }
                            ],
                            ")"
                           }
                          ],
                          "/;",
                          RowBox[
                           {
                            "FreeQ",
                            "[",
                            RowBox[{"df", ",", RowBox[{"_d", "|", "_dfunc"}]}],
                            "]"
                           }
                          ]
                         }
                        ]
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ],
                  "]"
                 }
                ]
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[11]:="
        ],
        Cell[
         CellGroupData[
          {
           Cell[
            BoxData[
             RowBox[
              {
               "dEval",
               "[",
               RowBox[
                {
                 RowBox[
                  {
                   RowBox[{"Erf", "[", RowBox[{"Sin", "[", "x", "]"}], "]"}],
                   "^",
                   "2"
                  }
                 ],
                 ",",
                 "x"
                }
               ],
               "]"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[13]:="
           ],
           Cell[
            BoxData[
             RowBox[
              {
               "2",
               " ",
               RowBox[{"Cos", "[", "x", "]"}],
               " ",
               RowBox[
                {
                 "dfunc",
                 "[",
                 RowBox[{"Erf", ",", RowBox[{"Sin", "[", "x", "]"}]}],
                 "]"
                }
               ],
               " ",
               RowBox[{"Erf", "[", RowBox[{"Sin", "[", "x", "]"}], "]"}]
              }
             ]
            ],
            "Output",
            CellLabel -> "Out[13]="
           ]
          },
          Open
         ]
        ]
       },
       Open
      ]
     ],
     Cell[
      CellGroupData[
       {
        Cell["\:6b65\:9aa4\:56de\:663e", "Section"],
        Cell[
         TextData[
          {
           Cell[BoxData[FormBox["=", TraditionalForm]]],
           " \:6807\:8bb0"
          }
         ],
         "Text"
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[{"echoStep", "[", "expr_", "]"}],
            ":=",
            RowBox[
             {
              "(",
              RowBox[
               {
                RowBox[
                 {
                  "CellPrint",
                  "@",
                  RowBox[
                   {
                    "Cell",
                    "[",
                    RowBox[
                     {
                      RowBox[
                       {
                        "BoxData",
                        "[",
                        RowBox[
                         {
                          "FormBox",
                          "[",
                          RowBox[
                           {
                            RowBox[
                             {
                              "ToBoxes",
                              "[",
                              RowBox[{"expr", ",", "TraditionalForm"}],
                              "]"
                             }
                            ],
                            ",",
                            "TraditionalForm"
                           }
                          ],
                          "]"
                         }
                        ],
                        "]"
                       }
                      ],
                      ",",
                      "\"Print\"",
                      ",",
                      "\[IndentingNewLine]",
                      RowBox[
                       {
                        "CellDingbat",
                        "->",
                        RowBox[
                         {"Cell", "[", RowBox[{"\"=\"", ",", "\"EchoLabel\""}], "]"}
                        ]
                       }
                      ]
                     }
                    ],
                    "]"
                   }
                  ]
                 }
                ],
                ";",
                "expr"
               }
              ],
              ")"
             }
            ]
           }
          ]
         ],
         "Input",
         CellLabel -> ""
        ],
        Cell["\:7b49\:5f0f\:8d77\:70b9\:548c\:8fb9\:8ddd", "Text"],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[{"echoStep0", "[", "expr_", "]"}],
            ":=",
            RowBox[
             {
              "(",
              "\[IndentingNewLine]",
              RowBox[
               {
                RowBox[
                 {
                  "CellPrint",
                  "@",
                  RowBox[
                   {
                    "Cell",
                    "[",
                    RowBox[
                     {
                      RowBox[
                       {
                        "BoxData",
                        "[",
                        RowBox[
                         {
                          "FormBox",
                          "[",
                          RowBox[
                           {
                            RowBox[
                             {
                              "ToBoxes",
                              "[",
                              RowBox[{"expr", ",", "TraditionalForm"}],
                              "]"
                             }
                            ],
                            ",",
                            "TraditionalForm"
                           }
                          ],
                          "]"
                         }
                        ],
                        "]"
                       }
                      ],
                      ",",
                      "\"Print\"",
                      ",",
                      "\[IndentingNewLine]",
                      RowBox[
                       {
                        "CellMargins",
                        "\[Rule]",
                        RowBox[
                         {
                          "{",
                          RowBox[
                           {
                            RowBox[
                             {"{", RowBox[{"Inherited", ",", " ", "Inherited"}], "}"}
                            ],
                            ",",
                            RowBox[{"{", RowBox[{"Inherited", ",", "Inherited"}], "}"}]
                           }
                          ],
                          "}"
                         }
                        ]
                       }
                      ]
                     }
                    ],
                    "]"
                   }
                  ]
                 }
                ],
                ";",
                "\[IndentingNewLine]",
                "expr"
               }
              ],
              ")"
             }
            ]
           }
          ]
         ],
         "Input"
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[{"echoStep", "[", "expr_", "]"}],
            ":=",
            RowBox[
             {
              "(",
              RowBox[
               {
                RowBox[
                 {
                  "CellPrint",
                  "@",
                  RowBox[
                   {
                    "Cell",
                    "[",
                    RowBox[
                     {
                      RowBox[
                       {
                        "BoxData",
                        "[",
                        RowBox[
                         {
                          "FormBox",
                          "[",
                          RowBox[
                           {
                            RowBox[
                             {
                              "ToBoxes",
                              "[",
                              RowBox[{"expr", ",", "TraditionalForm"}],
                              "]"
                             }
                            ],
                            ",",
                            "TraditionalForm"
                           }
                          ],
                          "]"
                         }
                        ],
                        "]"
                       }
                      ],
                      ",",
                      "\"Print\"",
                      ",",
                      "\[IndentingNewLine]",
                      RowBox[
                       {
                        "CellDingbat",
                        "->",
                        RowBox[
                         {"Cell", "[", RowBox[{"\"=\"", ",", "\"EchoLabel\""}], "]"}
                        ]
                       }
                      ],
                      ",",
                      "\[IndentingNewLine]",
                      RowBox[
                       {
                        "CellMargins",
                        "\[Rule]",
                        RowBox[
                         {
                          "{",
                          RowBox[
                           {
                            RowBox[
                             {
                              "{",
                              RowBox[
                               {RowBox[{"Inherited", "+", "20"}], ",", " ", "Inherited"}
                              ],
                              "}"
                             }
                            ],
                            ",",
                            RowBox[{"{", RowBox[{"Inherited", ",", "Inherited"}], "}"}]
                           }
                          ],
                          "}"
                         }
                        ]
                       }
                      ]
                     }
                    ],
                    "]"
                   }
                  ]
                 }
                ],
                ";",
                "expr"
               }
              ],
              ")"
             }
            ]
           }
          ]
         ],
         "Input"
        ],
        Cell["\:590d\:5408\:51fd\:6570\:5c42\:6b21", "Text"],
        Cell[
         BoxData[RowBox[{RowBox[{"$dDepth", "=", "0"}], ";"}]],
         "Input",
         CellLabel -> "In[14]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[{"echoStep0", "[", "expr_", "]"}],
            ":=",
            RowBox[
             {
              "(",
              "\[IndentingNewLine]",
              RowBox[
               {
                RowBox[
                 {
                  "CellPrint",
                  "@",
                  RowBox[
                   {
                    "Cell",
                    "[",
                    RowBox[
                     {
                      RowBox[
                       {
                        "BoxData",
                        "[",
                        RowBox[
                         {
                          "FormBox",
                          "[",
                          RowBox[
                           {
                            RowBox[
                             {
                              "ToBoxes",
                              "[",
                              RowBox[{"expr", ",", "TraditionalForm"}],
                              "]"
                             }
                            ],
                            ",",
                            "TraditionalForm"
                           }
                          ],
                          "]"
                         }
                        ],
                        "]"
                       }
                      ],
                      ",",
                      "\"Print\"",
                      ",",
                      "\[IndentingNewLine]",
                      RowBox[
                       {
                        "CellMargins",
                        "\[Rule]",
                        RowBox[
                         {
                          "{",
                          RowBox[
                           {
                            RowBox[
                             {
                              "{",
                              RowBox[
                               {
                                RowBox[
                                 {
                                  "Inherited",
                                  "+",
                                  RowBox[
                                   {"20", RowBox[{"(", RowBox[{"$dDepth", "-", "1"}], ")"}]}
                                  ]
                                 }
                                ],
                                ",",
                                " ",
                                "Inherited"
                               }
                              ],
                              "}"
                             }
                            ],
                            ",",
                            RowBox[{"{", RowBox[{"Inherited", ",", "Inherited"}], "}"}]
                           }
                          ],
                          "}"
                         }
                        ]
                       }
                      ]
                     }
                    ],
                    "]"
                   }
                  ]
                 }
                ],
                ";",
                "\[IndentingNewLine]",
                "expr"
               }
              ],
              ")"
             }
            ]
           }
          ]
         ],
         "Input",
         CellLabel -> "In[15]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[{"echoStep", "[", "expr_", "]"}],
            ":=",
            RowBox[
             {
              "(",
              RowBox[
               {
                RowBox[
                 {
                  "CellPrint",
                  "@",
                  RowBox[
                   {
                    "Cell",
                    "[",
                    RowBox[
                     {
                      RowBox[
                       {
                        "BoxData",
                        "[",
                        RowBox[
                         {
                          "FormBox",
                          "[",
                          RowBox[
                           {
                            RowBox[
                             {
                              "ToBoxes",
                              "[",
                              RowBox[{"expr", ",", "TraditionalForm"}],
                              "]"
                             }
                            ],
                            ",",
                            "TraditionalForm"
                           }
                          ],
                          "]"
                         }
                        ],
                        "]"
                       }
                      ],
                      ",",
                      "\"Print\"",
                      ",",
                      "\[IndentingNewLine]",
                      RowBox[
                       {
                        "CellDingbat",
                        "->",
                        RowBox[
                         {"Cell", "[", RowBox[{"\"=\"", ",", "\"EchoLabel\""}], "]"}
                        ]
                       }
                      ],
                      ",",
                      "\[IndentingNewLine]",
                      RowBox[
                       {
                        "CellMargins",
                        "\[Rule]",
                        RowBox[
                         {
                          "{",
                          RowBox[
                           {
                            RowBox[
                             {
                              "{",
                              RowBox[
                               {
                                RowBox[{"Inherited", "+", RowBox[{"20", "$dDepth"}]}],
                                ",",
                                " ",
                                "Inherited"
                               }
                              ],
                              "}"
                             }
                            ],
                            ",",
                            RowBox[{"{", RowBox[{"Inherited", ",", "Inherited"}], "}"}]
                           }
                          ],
                          "}"
                         }
                        ]
                       }
                      ]
                     }
                    ],
                    "]"
                   }
                  ]
                 }
                ],
                ";",
                "expr"
               }
              ],
              ")"
             }
            ]
           }
          ]
         ],
         "Input",
         CellLabel -> "In[16]:="
        ],
        Cell["\:8ba1\:7b97\:90e8\:5206", "Text"],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[{"dEval", "[", RowBox[{"f_", ",", "x_"}], "]"}],
            ":=",
            RowBox[
             {
              "Block",
              "[",
              RowBox[
               {
                RowBox[
                 {
                  "{",
                  RowBox[{"$dDepth", "=", RowBox[{"$dDepth", "+", "1"}]}],
                  "}"
                 }
                ],
                ",",
                RowBox[{"dEvalR", "[", RowBox[{"f", ",", "x"}], "]"}]
               }
              ],
              "]"
             }
            ]
           }
          ]
         ],
         "Input",
         CellLabel -> "In[17]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[{"dEvalR", "[", RowBox[{"f_", ",", "x_"}], "]"}],
            ":=",
            RowBox[
             {
              "NestWhile",
              "[",
              RowBox[
               {
                RowBox[
                 {
                  "echoStep",
                  "@*",
                  RowBox[{"ReplaceAll", "[", "allRules", "]"}]
                 }
                ],
                ",",
                RowBox[
                 {
                  "echoStep0",
                  "[",
                  RowBox[{"d", "[", RowBox[{"f", ",", "x"}], "]"}],
                  "]"
                 }
                ],
                ",",
                RowBox[
                 {
                  RowBox[
                   {
                    RowBox[
                     {
                      "!",
                      RowBox[
                       {
                        "FreeQ",
                        "[",
                        RowBox[{"#2", ",", RowBox[{"_d", "|", "_dfunc"}]}],
                        "]"
                       }
                      ]
                     }
                    ],
                    "&&",
                    RowBox[{"UnsameQ", "[", "##", "]"}]
                   }
                  ],
                  "&"
                 }
                ],
                ",",
                "2"
               }
              ],
              "]"
             }
            ]
           }
          ]
         ],
         "Input",
         CellLabel -> "In[18]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[{"stepD", "[", RowBox[{"f_", ",", "x_"}], "]"}],
            ":=",
            RowBox[
             {
              "With",
              "[",
              RowBox[
               {
                RowBox[
                 {
                  "{",
                  RowBox[
                   {
                    "eval",
                    "=",
                    RowBox[{"dEval", "[", RowBox[{"f", ",", "x"}], "]"}]
                   }
                  ],
                  "}"
                 }
                ],
                ",",
                RowBox[
                 {
                  "eval",
                  "/;",
                  RowBox[
                   {
                    "FreeQ",
                    "[",
                    RowBox[{"eval", ",", RowBox[{"_d", "|", "_dfunc"}]}],
                    "]"
                   }
                  ]
                 }
                ]
               }
              ],
              "]"
             }
            ]
           }
          ]
         ],
         "Input",
         CellLabel -> "In[19]:="
        ],
        Cell["\:6d4b\:8bd5", "Text"],
        Cell[
         CellGroupData[
          {
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 RowBox[{"(", RowBox[{"stepD", "\[Equal]", "D"}], ")"}],
                 "[",
                 RowBox[
                  {
                   RowBox[
                    {
                     "Log",
                     "[",
                     RowBox[
                      {
                       "Sec",
                       "[",
                       RowBox[{RowBox[{"3", "^", "x"}], "-", "1"}],
                       "]"
                      }
                     ],
                     "]"
                    }
                   ],
                   ",",
                   "x"
                  }
                 ],
                 "]"
                }
               ],
               "//",
               "Through"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[20]:="
           ],
           Cell[
            CellGroupData[
             {
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    "d",
                    "(",
                    RowBox[
                     {
                      RowBox[
                       {
                        "log",
                        "(",
                        RowBox[
                         {
                          "sec",
                          "(",
                          RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                          ")"
                         }
                        ],
                        ")"
                       }
                      ],
                      ",",
                      "x"
                     }
                    ],
                    ")"
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellMargins -> {{Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[
                     {
                      "d",
                      "(",
                      RowBox[
                       {
                        RowBox[
                         {
                          "sec",
                          "(",
                          RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                          ")"
                         }
                        ],
                        ",",
                        "x"
                       }
                      ],
                      ")"
                     }
                    ],
                    " ",
                    RowBox[
                     {
                      "dfunc",
                      "(",
                      RowBox[
                       {
                        "Log",
                        ",",
                        RowBox[
                         {
                          "sec",
                          "(",
                          RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                          ")"
                         }
                        ]
                       }
                      ],
                      ")"
                     }
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    "d",
                    "(",
                    RowBox[
                     {RowBox[{"log", "(", "u$3910", ")"}], ",", "u$3910"}
                    ],
                    ")"
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[FractionBox["1", "u$3910"], TraditionalForm],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{40 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[
                     {
                      "cos",
                      "(",
                      RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                      ")"
                     }
                    ],
                    " ",
                    RowBox[
                     {
                      "d",
                      "(",
                      RowBox[
                       {RowBox[{"1", "-", SuperscriptBox["3", "x"]}], ",", "x"}
                      ],
                      ")"
                     }
                    ],
                    " ",
                    RowBox[
                     {
                      "dfunc",
                      "(",
                      RowBox[
                       {"Sec", ",", RowBox[{"1", "-", SuperscriptBox["3", "x"]}]}
                      ],
                      ")"
                     }
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    "d",
                    "(",
                    RowBox[
                     {RowBox[{"sec", "(", "u$3922", ")"}], ",", "u$3922"}
                    ],
                    ")"
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[{"tan", "(", "u$3922", ")"}],
                    " ",
                    RowBox[{"sec", "(", "u$3922", ")"}]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{40 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[
                     {
                      "tan",
                      "(",
                      RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                      ")"
                     }
                    ],
                    " ",
                    RowBox[
                     {
                      "(",
                      RowBox[
                       {
                        RowBox[{"d", "(", RowBox[{"1", ",", "x"}], ")"}],
                        "+",
                        RowBox[
                         {
                          "d",
                          "(",
                          RowBox[{RowBox[{"-", SuperscriptBox["3", "x"]}], ",", "x"}],
                          ")"
                         }
                        ]
                       }
                      ],
                      ")"
                     }
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[
                     {
                      "tan",
                      "(",
                      RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                      ")"
                     }
                    ],
                    " ",
                    RowBox[
                     {
                      "(",
                      RowBox[
                       {
                        "-",
                        RowBox[
                         {
                          "d",
                          "(",
                          RowBox[{SuperscriptBox["3", "x"], ",", "x"}],
                          ")"
                         }
                        ]
                       }
                      ],
                      ")"
                     }
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[{"-", SuperscriptBox["3", "x"]}],
                    " ",
                    RowBox[{"log", "(", "3", ")"}],
                    " ",
                    RowBox[
                     {
                      "tan",
                      "(",
                      RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                      ")"
                     }
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ]
             },
             Open
            ]
           ],
           Cell[BoxData["True"], "Output", CellLabel -> "Out[20]="]
          },
          Open
         ]
        ]
       },
       Open
      ]
     ],
     Cell[
      CellGroupData[
       {
        Cell["\:6da6\:8272\:5916\:89c2", "Section"],
        Cell[
         BoxData[
          RowBox[
           {
            "d",
            "/:",
            RowBox[
             {
              "MakeBoxes",
              "[",
              RowBox[
               {
                RowBox[{"d", "[", RowBox[{"f_", ",", "x_"}], "]"}],
                ",",
                "TraditionalForm"
               }
              ],
              "]"
             }
            ],
            ":=",
            RowBox[
             {
              "Module",
              "[",
              RowBox[
               {
                RowBox[{"{", "boxes", "}"}],
                ",",
                "\n",
                "  ",
                RowBox[
                 {
                  RowBox[
                   {
                    "boxes",
                    "=",
                    RowBox[
                     {
                      "MakeBoxes",
                      "[",
                      RowBox[{"f", ",", " ", "TraditionalForm"}],
                      "]"
                     }
                    ]
                   }
                  ],
                  ";",
                  "\n",
                  "  ",
                  RowBox[
                   {
                    "If",
                    "[",
                    RowBox[
                     {
                      RowBox[
                       {
                        RowBox[{"Precedence", "[", "Plus", "]"}],
                        ">=",
                        RowBox[
                         {
                          "Precedence",
                          "[",
                          RowBox[{"boxes", ",", "TraditionalForm"}],
                          "]"
                         }
                        ]
                       }
                      ],
                      ",",
                      RowBox[
                       {
                        "boxes",
                        "=",
                        RowBox[
                         {
                          "RowBox",
                          "[",
                          RowBox[
                           {
                            "{",
                            RowBox[{"\"(\"", ",", " ", "boxes", ",", " ", "\")\""}],
                            "}"
                           }
                          ],
                          "]"
                         }
                        ]
                       }
                      ]
                     }
                    ],
                    "]"
                   }
                  ],
                  ";",
                  "\n",
                  "  ",
                  RowBox[
                   {
                    "RowBox",
                    "[",
                    RowBox[
                     {
                      "{",
                      RowBox[
                       {
                        RowBox[
                         {
                          "FractionBox",
                          "[",
                          RowBox[
                           {
                            "\"\[DifferentialD]\"",
                            ",",
                            " ",
                            RowBox[
                             {
                              "RowBox",
                              "[",
                              RowBox[
                               {
                                "{",
                                RowBox[
                                 {
                                  "\"\[DifferentialD]\"",
                                  ",",
                                  " ",
                                  RowBox[
                                   {
                                    "MakeBoxes",
                                    "[",
                                    RowBox[{"x", ",", " ", "TraditionalForm"}],
                                    "]"
                                   }
                                  ]
                                 }
                                ],
                                "}"
                               }
                              ],
                              "]"
                             }
                            ]
                           }
                          ],
                          "]"
                         }
                        ],
                        ",",
                        " ",
                        "boxes"
                       }
                      ],
                      "}"
                     }
                    ],
                    "]"
                   }
                  ]
                 }
                ]
               }
              ],
              "\n",
              "]"
             }
            ]
           }
          ]
         ],
         "Input",
         CellLabel -> "In[21]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            "dfunc",
            "/:",
            RowBox[
             {
              "MakeBoxes",
              "[",
              RowBox[
               {
                RowBox[{"dfunc", "[", RowBox[{"f_", ",", " ", "g_"}], "]"}],
                ",",
                " ",
                "TraditionalForm"
               }
              ],
              "]"
             }
            ],
            ":=",
            RowBox[
             {
              "Module",
              "[",
              RowBox[
               {
                RowBox[{"{", RowBox[{"fboxes", ",", " ", "gboxes"}], "}"}],
                ",",
                "\n",
                "  ",
                RowBox[
                 {
                  RowBox[
                   {
                    "fboxes",
                    "=",
                    RowBox[
                     {
                      "ToBoxes",
                      "[",
                      RowBox[
                       {RowBox[{"f", "[", "g", "]"}], ",", " ", "TraditionalForm"}
                      ],
                      "]"
                     }
                    ]
                   }
                  ],
                  ";",
                  " ",
                  RowBox[
                   {
                    "gboxes",
                    "=",
                    RowBox[
                     {
                      "ToBoxes",
                      "[",
                      RowBox[{"g", ",", " ", "TraditionalForm"}],
                      "]"
                     }
                    ]
                   }
                  ],
                  ";",
                  "\n",
                  "  ",
                  RowBox[
                   {
                    "If",
                    "[",
                    RowBox[
                     {
                      RowBox[
                       {
                        RowBox[{"Precedence", "[", "Plus", "]"}],
                        ">=",
                        RowBox[
                         {
                          "Precedence",
                          "[",
                          RowBox[{"fboxes", ",", " ", "TraditionalForm"}],
                          "]"
                         }
                        ]
                       }
                      ],
                      ",",
                      RowBox[
                       {
                        "fboxes",
                        "=",
                        RowBox[
                         {
                          "RowBox",
                          "[",
                          RowBox[
                           {
                            "{",
                            RowBox[{"\"(\"", ",", " ", "fboxes", ",", " ", "\")\""}],
                            "}"
                           }
                          ],
                          "]"
                         }
                        ]
                       }
                      ]
                     }
                    ],
                    "]"
                   }
                  ],
                  ";",
                  "\n",
                  "  ",
                  RowBox[
                   {
                    "If",
                    "[",
                    RowBox[
                     {
                      RowBox[
                       {
                        RowBox[{"Precedence", "[", "Plus", "]"}],
                        ">=",
                        RowBox[
                         {
                          "Precedence",
                          "[",
                          RowBox[{"gboxes", ",", " ", "TraditionalForm"}],
                          "]"
                         }
                        ]
                       }
                      ],
                      ",",
                      RowBox[
                       {
                        "gboxes",
                        "=",
                        RowBox[
                         {
                          "RowBox",
                          "[",
                          RowBox[
                           {
                            "{",
                            RowBox[{"\"(\"", ",", " ", "gboxes", ",", " ", "\")\""}],
                            "}"
                           }
                          ],
                          "]"
                         }
                        ]
                       }
                      ]
                     }
                    ],
                    "]"
                   }
                  ],
                  ";",
                  "\n",
                  "  ",
                  RowBox[
                   {
                    "FractionBox",
                    "[",
                    RowBox[
                     {
                      RowBox[
                       {
                        "RowBox",
                        "[",
                        RowBox[
                         {
                          "{",
                          RowBox[{"\"\[DifferentialD]\"", ",", " ", "fboxes"}],
                          "}"
                         }
                        ],
                        "]"
                       }
                      ],
                      ",",
                      " ",
                      RowBox[
                       {
                        "RowBox",
                        "[",
                        RowBox[
                         {
                          "{",
                          RowBox[{"\"\[DifferentialD]\"", ",", " ", "gboxes"}],
                          "}"
                         }
                        ],
                        "]"
                       }
                      ]
                     }
                    ],
                    "]"
                   }
                  ]
                 }
                ]
               }
              ],
              "\n",
              "]"
             }
            ]
           }
          ]
         ],
         "Input",
         CellLabel -> "In[22]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[{"makeXForm", "[", "sym_Symbol", "]"}],
            ":=",
            RowBox[
             {
              "sym",
              "/:",
              RowBox[
               {
                "MakeBoxes",
                "[",
                RowBox[{"sym", ",", "TraditionalForm"}],
                "]"
               }
              ],
              "=",
              RowBox[
               {
                "ToBoxes",
                "[",
                RowBox[
                 {
                  RowBox[
                   {
                    "Symbol",
                    "[",
                    RowBox[
                     {
                      "StringPart",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {"ToString", "[", RowBox[{"sym", ",", "InputForm"}], "]"}
                        ],
                        ",",
                        "1"
                       }
                      ],
                      "]"
                     }
                    ],
                    "]"
                   }
                  ],
                  ",",
                  "TraditionalForm"
                 }
                ],
                "]"
               }
              ]
             }
            ]
           }
          ]
         ],
         "Input",
         CellLabel -> "In[23]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "substRules",
              "=",
              RowBox[
               {
                RowBox[{"dfunc", "[", RowBox[{"f_", ",", "g_"}], "]"}],
                "\[RuleDelayed]",
                RowBox[
                 {
                  "Module",
                  "[",
                  RowBox[
                   {
                    RowBox[{"{", "u", "}"}],
                    ",",
                    RowBox[
                     {
                      RowBox[{"makeXForm", "[", "u", "]"}],
                      ";",
                      RowBox[
                       {
                        "With",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {
                            "{",
                            RowBox[
                             {
                              "df",
                              "=",
                              RowBox[
                               {
                                "dEval",
                                "[",
                                RowBox[{RowBox[{"f", "[", "u", "]"}], ",", "u"}],
                                "]"
                               }
                              ]
                             }
                            ],
                            "}"
                           }
                          ],
                          ",",
                          RowBox[
                           {
                            RowBox[
                             {
                              "(",
                              RowBox[
                               {
                                "df",
                                "/.",
                                RowBox[{"{", RowBox[{"u", "\[Rule]", "g"}], "}"}]
                               }
                              ],
                              ")"
                             }
                            ],
                            "/;",
                            RowBox[
                             {
                              "FreeQ",
                              "[",
                              RowBox[{"df", ",", RowBox[{"_d", "|", "_dfunc"}]}],
                              "]"
                             }
                            ]
                           }
                          ]
                         }
                        ],
                        "]"
                       }
                      ]
                     }
                    ]
                   }
                  ],
                  "]"
                 }
                ]
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[24]:="
        ],
        Cell[
         CellGroupData[
          {
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 RowBox[{"(", RowBox[{"stepD", "\[Equal]", "D"}], ")"}],
                 "[",
                 RowBox[
                  {
                   RowBox[
                    {
                     "Log",
                     "[",
                     RowBox[
                      {
                       "Sec",
                       "[",
                       RowBox[{RowBox[{"3", "^", "x"}], "-", "1"}],
                       "]"
                      }
                     ],
                     "]"
                    }
                   ],
                   ",",
                   "x"
                  }
                 ],
                 "]"
                }
               ],
               "//",
               "Through"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[26]:="
           ],
           Cell[
            CellGroupData[
             {
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    FractionBox[
                     "\[DifferentialD]",
                     RowBox[{"\[DifferentialD]", "x"}]
                    ],
                    RowBox[
                     {
                      "log",
                      "(",
                      RowBox[
                       {
                        "sec",
                        "(",
                        RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                        ")"
                       }
                      ],
                      ")"
                     }
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellMargins -> {{Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[
                     {
                      "(",
                      RowBox[
                       {
                        FractionBox[
                         "\[DifferentialD]",
                         RowBox[{"\[DifferentialD]", "x"}]
                        ],
                        RowBox[
                         {
                          "sec",
                          "(",
                          RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                          ")"
                         }
                        ]
                       }
                      ],
                      ")"
                     }
                    ],
                    " ",
                    FractionBox[
                     RowBox[
                      {
                       "\[DifferentialD]",
                       FormBox[
                        RowBox[
                         {
                          "log",
                          "(",
                          RowBox[
                           {
                            "sec",
                            "(",
                            RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                            ")"
                           }
                          ],
                          ")"
                         }
                        ],
                        TraditionalForm
                       ]
                      }
                     ],
                     RowBox[
                      {
                       "\[DifferentialD]",
                       FormBox[
                        RowBox[
                         {
                          "sec",
                          "(",
                          RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                          ")"
                         }
                        ],
                        TraditionalForm
                       ]
                      }
                     ]
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    FractionBox[
                     "\[DifferentialD]",
                     RowBox[{"\[DifferentialD]", FormBox["u", TraditionalForm]}]
                    ],
                    RowBox[{"log", "(", FormBox["u", TraditionalForm], ")"}]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  FractionBox["1", FormBox["u", TraditionalForm]],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{40 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[
                     {
                      "(",
                      RowBox[
                       {
                        FractionBox[
                         "\[DifferentialD]",
                         RowBox[{"\[DifferentialD]", "x"}]
                        ],
                        RowBox[
                         {"(", RowBox[{"1", "-", SuperscriptBox["3", "x"]}], ")"}
                        ]
                       }
                      ],
                      ")"
                     }
                    ],
                    " ",
                    RowBox[
                     {
                      "cos",
                      "(",
                      RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                      ")"
                     }
                    ],
                    " ",
                    FractionBox[
                     RowBox[
                      {
                       "\[DifferentialD]",
                       FormBox[
                        RowBox[
                         {
                          "sec",
                          "(",
                          RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                          ")"
                         }
                        ],
                        TraditionalForm
                       ]
                      }
                     ],
                     RowBox[
                      {
                       "\[DifferentialD]",
                       RowBox[
                        {
                         "(",
                         FormBox[
                          RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                          TraditionalForm
                         ],
                         ")"
                        }
                       ]
                      }
                     ]
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    FractionBox[
                     "\[DifferentialD]",
                     RowBox[{"\[DifferentialD]", FormBox["u", TraditionalForm]}]
                    ],
                    RowBox[{"sec", "(", FormBox["u", TraditionalForm], ")"}]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[{"tan", "(", FormBox["u", TraditionalForm], ")"}],
                    " ",
                    RowBox[{"sec", "(", FormBox["u", TraditionalForm], ")"}]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{40 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[
                     {
                      "(",
                      RowBox[
                       {
                        RowBox[
                         {
                          FractionBox[
                           "\[DifferentialD]",
                           RowBox[{"\[DifferentialD]", "x"}]
                          ],
                          "1"
                         }
                        ],
                        "+",
                        RowBox[
                         {
                          FractionBox[
                           "\[DifferentialD]",
                           RowBox[{"\[DifferentialD]", "x"}]
                          ],
                          RowBox[{"-", SuperscriptBox["3", "x"]}]
                         }
                        ]
                       }
                      ],
                      ")"
                     }
                    ],
                    " ",
                    RowBox[
                     {
                      "tan",
                      "(",
                      RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                      ")"
                     }
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[
                     {
                      "-",
                      RowBox[
                       {
                        "(",
                        RowBox[
                         {
                          FractionBox[
                           "\[DifferentialD]",
                           RowBox[{"\[DifferentialD]", "x"}]
                          ],
                          SuperscriptBox["3", "x"]
                         }
                        ],
                        ")"
                       }
                      ]
                     }
                    ],
                    " ",
                    RowBox[
                     {
                      "tan",
                      "(",
                      RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                      ")"
                     }
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ],
              Cell[
               BoxData[
                FormBox[
                 FormBox[
                  RowBox[
                   {
                    RowBox[{"-", SuperscriptBox["3", "x"]}],
                    " ",
                    RowBox[{"log", "(", "3", ")"}],
                    " ",
                    RowBox[
                     {
                      "tan",
                      "(",
                      RowBox[{"1", "-", SuperscriptBox["3", "x"]}],
                      ")"
                     }
                    ]
                   }
                  ],
                  TraditionalForm
                 ],
                 TraditionalForm
                ]
               ],
               "Print",
               CellDingbat -> Cell["=", "EchoLabel"],
               CellMargins -> {{20 + Inherited, Inherited}, {Inherited, Inherited}}
              ]
             },
             Open
            ]
           ],
           Cell[BoxData["True"], "Output", CellLabel -> "Out[26]="]
          },
          Open
         ]
        ]
       },
       Open
      ]
     ],
     Cell[
      CellGroupData[
       {
        Cell["\:6807\:6ce8\:6b65\:9aa4", "Section"],
        Cell["\:6807\:6ce8\:89c4\:5219", "Text"],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "baseRules",
              "=",
              RowBox[
               {
                "{",
                "\[IndentingNewLine]",
                RowBox[
                 {
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[{"d", "[", RowBox[{"c_", ",", "x_"}], "]"}],
                      "/;",
                      RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "dLabeled",
                      "[",
                      RowBox[{"0", ",", "\"Constant Rule\""}],
                      "]"
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[{"d", "[", RowBox[{"lf_Plus", ",", "x_"}], "]"}],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "dLabeled",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          "Thread",
                          "[",
                          RowBox[
                           {
                            RowBox[{"d", "[", RowBox[{"lf", ",", "x"}], "]"}],
                            ",",
                            "Plus"
                           }
                          ],
                          "]"
                         }
                        ],
                        ",",
                        "\"Linearity Rule\""
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[{RowBox[{"c_", " ", "f_"}], ",", "x_"}],
                        "]"
                       }
                      ],
                      "/;",
                      RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "dLabeled",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          "c",
                          " ",
                          RowBox[{"d", "[", RowBox[{"f", ",", "x"}], "]"}]
                         }
                        ],
                        ",",
                        "\"Linearity Rule\""
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      "d",
                      "[",
                      RowBox[{RowBox[{"f_", " ", "g_"}], ",", "x_"}],
                      "]"
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "dLabeled",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          RowBox[
                           {RowBox[{"d", "[", RowBox[{"f", ",", "x"}], "]"}], "g"}
                          ],
                          "+",
                          RowBox[
                           {RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}], "f"}
                          ]
                         }
                        ],
                        ",",
                        "\"Product Rule\""
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ]
                 }
                ],
                "\[IndentingNewLine]",
                "}"
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[27]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "higherRules",
              "=",
              RowBox[
               {
                "{",
                "\[IndentingNewLine]",
                RowBox[
                 {
                  RowBox[
                   {
                    RowBox[
                     {
                      "HoldPattern",
                      "@",
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {
                            RowBox[{"InverseFunction", "[", "f_", "]"}],
                            "[",
                            "x_",
                            "]"
                           }
                          ],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "dLabeled",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          "1",
                          "/",
                          RowBox[
                           {
                            "dfunc",
                            "[",
                            RowBox[
                             {
                              "f",
                              ",",
                              RowBox[
                               {RowBox[{"InverseFunction", "[", "f", "]"}], "[", "x", "]"}
                              ]
                             }
                            ],
                            "]"
                           }
                          ]
                         }
                        ],
                        ",",
                        "\"Inverse Function Rule\""
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[{RowBox[{"f_", "[", "g_", "]"}], ",", "x_"}],
                        "]"
                       }
                      ],
                      "/;",
                      RowBox[{"g", "=!=", "x"}]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "dLabeled",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          RowBox[{"dfunc", "[", RowBox[{"f", ",", "g"}], "]"}],
                          " ",
                          RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}]
                         }
                        ],
                        ",",
                        "\"Chain Rule\""
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[{"f_", "[", RowBox[{"g_", ",", "c_"}], "]"}],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ],
                      "/;",
                      RowBox[
                       {
                        RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}],
                        "&&",
                        RowBox[{"g", "=!=", "x"}]
                       }
                      ]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "dLabeled",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          RowBox[
                           {
                            "dfunc",
                            "[",
                            RowBox[
                             {
                              RowBox[
                               {RowBox[{"f", "[", RowBox[{"#", ",", "c"}], "]"}], "&"}
                              ],
                              ",",
                              "g"
                             }
                            ],
                            "]"
                           }
                          ],
                          " ",
                          RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}]
                         }
                        ],
                        ",",
                        "\"Chain Rule\""
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ],
                  ",",
                  "\[IndentingNewLine]",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[
                       {
                        "d",
                        "[",
                        RowBox[
                         {
                          RowBox[{"f_", "[", RowBox[{"c_", ",", "g_"}], "]"}],
                          ",",
                          "x_"
                         }
                        ],
                        "]"
                       }
                      ],
                      "/;",
                      RowBox[
                       {
                        RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}],
                        "&&",
                        RowBox[{"g", "=!=", "x"}]
                       }
                      ]
                     }
                    ],
                    "\[RuleDelayed]",
                    RowBox[
                     {
                      "dLabeled",
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          RowBox[
                           {
                            "dfunc",
                            "[",
                            RowBox[
                             {
                              RowBox[
                               {RowBox[{"f", "[", RowBox[{"c", ",", "#"}], "]"}], "&"}
                              ],
                              ",",
                              "g"
                             }
                            ],
                            "]"
                           }
                          ],
                          " ",
                          RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}]
                         }
                        ],
                        ",",
                        "\"Chain Rule\""
                       }
                      ],
                      "]"
                     }
                    ]
                   }
                  ]
                 }
                ],
                "\[IndentingNewLine]",
                "}"
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[28]:="
        ],
        Cell[
         BoxData[
          RowBox[
           {
            RowBox[
             {
              "substRules",
              "=",
              RowBox[
               {
                RowBox[{"dfunc", "[", RowBox[{"f_", ",", "g_"}], "]"}],
                "\[RuleDelayed]",
                RowBox[
                 {
                  "Module",
                  "[",
                  RowBox[
                   {
                    RowBox[{"{", "u", "}"}],
                    ",",
                    RowBox[
                     {
                      RowBox[{"makeXForm", "[", "u", "]"}],
                      ";",
                      RowBox[
                       {
                        "With",
                        "[",
                        RowBox[
                         {
                          RowBox[
                           {
                            "{",
                            RowBox[
                             {
                              "df",
                              "=",
                              RowBox[
                               {
                                "dEval",
                                "[",
                                RowBox[
                                 {
                                  RowBox[
                                   {
                                    "dLabeled",
                                    "[",
                                    RowBox[
                                     {
                                      RowBox[{"f", "[", "u", "]"}],
                                      ",",
                                      RowBox[
                                       {
                                        "Row",
                                        "@",
                                        RowBox[
                                         {
                                          "{",
                                          RowBox[
                                           {
                                            "\"where \"",
                                            ",",
                                            RowBox[
                                             {
                                              "TraditionalForm",
                                              "[",
                                              RowBox[{"u", "\[Equal]", "g"}],
                                              "]"
                                             }
                                            ]
                                           }
                                          ],
                                          "}"
                                         }
                                        ]
                                       }
                                      ]
                                     }
                                    ],
                                    "]"
                                   }
                                  ],
                                  ",",
                                  "u"
                                 }
                                ],
                                "]"
                               }
                              ]
                             }
                            ],
                            "}"
                           }
                          ],
                          ",",
                          RowBox[
                           {
                            RowBox[
                             {
                              "(",
                              RowBox[
                               {
                                "df",
                                "/.",
                                RowBox[{"{", RowBox[{"u", "\[Rule]", "g"}], "}"}]
                               }
                              ],
                              ")"
                             }
                            ],
                            "/;",
                            RowBox[
                             {
                              "FreeQ",
                              "[",
                              RowBox[{"df", ",", RowBox[{"_d", "|", "_dfunc"}]}],
                              "]"
                             }
                            ]
                           }
                          ]
                         }
                        ],
                        "]"
                       }
                      ]
                     }
                    ]
                   }
                  ],
                  "]"
                 }
                ]
               }
              ]
             }
            ],
            ";"
           }
          ]
         ],
         "Input",
         CellLabel -> "In[29]:="
        ]
       },
       Open
      ]
     ]
    },
    Open
   ]
  ]
 },
 InputAliases -> {
  "rg" -> "\:7984",
  "notation" -> RowBox[
   {
    "Notation",
    "[",
    RowBox[
     {
      TemplateBox[
       {"\[SelectionPlaceholder]"},
       "NotationTemplateTag"
      ],
      " ",
      "\[DoubleLongLeftRightArrow]",
      " ",
      TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]
     }
    ],
    "]"
   }
  ],
  "notation>" -> RowBox[
   {
    "Notation",
    "[",
    RowBox[
     {
      TemplateBox[
       {"\[SelectionPlaceholder]"},
       "NotationTemplateTag"
      ],
      " ",
      "\[DoubleLongRightArrow]",
      " ",
      TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]
     }
    ],
    "]"
   }
  ],
  "notation<" -> RowBox[
   {
    "Notation",
    "[",
    RowBox[
     {
      TemplateBox[
       {"\[SelectionPlaceholder]"},
       "NotationTemplateTag"
      ],
      " ",
      "\[DoubleLongLeftArrow]",
      " ",
      TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]
     }
    ],
    "]"
   }
  ],
  "symb" -> RowBox[
   {
    "Symbolize",
    "[",
    TemplateBox[
     {"\[SelectionPlaceholder]"},
     "NotationTemplateTag"
    ],
    "]"
   }
  ],
  "infixnotation" -> RowBox[
   {
    "InfixNotation",
    "[",
    RowBox[
     {
      TemplateBox[
       {"\[SelectionPlaceholder]"},
       "NotationTemplateTag"
      ],
      ",",
      "\[Placeholder]"
     }
    ],
    "]"
   }
  ],
  "addia" -> RowBox[
   {
    "AddInputAlias",
    "[",
    RowBox[
     {
      "\"\[SelectionPlaceholder]\"",
      "\[Rule]",
      TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]
     }
    ],
    "]"
   }
  ],
  "pattwraper" -> TemplateBox[
   {"\[SelectionPlaceholder]"},
   "NotationPatternTag"
  ],
  "madeboxeswraper" -> TemplateBox[
   {"\[SelectionPlaceholder]"},
   "NotationMadeBoxesTag"
  ],
  "cf" -> SubscriptBox["&", "\[Placeholder]"]
 },
 StyleDefinitions -> "Default.nb"
]
Notebook[
 {
  Cell[
   CellGroupData[
    {
     Cell[
      "\:5e26\:6b65\:9aa4\:7684\:521d\:7b49\:51fd\:6570\:6c42\:5bfc",
      "Title"
     ],
     Cell[
      CellGroupData[
       {
        Cell["\:6c42\:5bfc\:89c4\:5219", "Section"],
        Cell[
         BoxData[RowBox[{"ClearAll", "[", "\"`*\"", "]"}]],
         "Input",
         CellLabel -> "In[43]:="
        ],
        Cell[
         CellGroupData[
          {
           Cell["\:4ee3\:7801", "Subsection"],
           Cell["\:57fa\:672c\:89c4\:5219", "Text"],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "baseRules",
                 "=",
                 RowBox[
                  {
                   "{",
                   "\[IndentingNewLine]",
                   RowBox[
                    {
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[{"d", "[", RowBox[{"c_", ",", "x_"}], "]"}],
                         "/;",
                         RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}]
                        }
                       ],
                       "\[RuleDelayed]",
                       "0"
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[{"d", "[", RowBox[{"lf_Plus", ",", "x_"}], "]"}],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         "Thread",
                         "[",
                         RowBox[
                          {
                           RowBox[{"d", "[", RowBox[{"lf", ",", "x"}], "]"}],
                           ",",
                           "Plus"
                          }
                         ],
                         "]"
                        }
                       ]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[{RowBox[{"c_", " ", "f_"}], ",", "x_"}],
                           "]"
                          }
                         ],
                         "/;",
                         RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}]
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         "c",
                         " ",
                         RowBox[{"d", "[", RowBox[{"f", ",", "x"}], "]"}]
                        }
                       ]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         "d",
                         "[",
                         RowBox[{RowBox[{"f_", " ", "g_"}], ",", "x_"}],
                         "]"
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         RowBox[
                          {
                           RowBox[{"d", "[", RowBox[{"f", ",", "x"}], "]"}],
                           " ",
                           "g"
                          }
                         ],
                         "+",
                         RowBox[
                          {
                           RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}],
                           " ",
                           "f"
                          }
                         ]
                        }
                       ]
                      }
                     ]
                    }
                   ],
                   "\[IndentingNewLine]",
                   "}"
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[1]:="
           ],
           Cell[
            "\:9ad8\:9636\:89c4\:5219\:ff08\:53cd\:51fd\:6570/\:590d\:5408\:51fd\:6570\:ff09",
            "Text"
           ],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "higherRules",
                 "=",
                 RowBox[
                  {
                   "{",
                   "\[IndentingNewLine]",
                   RowBox[
                    {
                     RowBox[
                      {
                       RowBox[
                        {
                         "HoldPattern",
                         "@",
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[
                            {
                             RowBox[
                              {
                               RowBox[{"InverseFunction", "[", "f_", "]"}],
                               "[",
                               "x_",
                               "]"
                              }
                             ],
                             ",",
                             "x_"
                            }
                           ],
                           "]"
                          }
                         ]
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         "1",
                         "/",
                         RowBox[
                          {
                           "dfunc",
                           "[",
                           RowBox[
                            {
                             "f",
                             ",",
                             RowBox[
                              {RowBox[{"InverseFunction", "[", "f", "]"}], "[", "x", "]"}
                             ]
                            }
                           ],
                           "]"
                          }
                         ]
                        }
                       ]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[{RowBox[{"f_", "[", "g_", "]"}], ",", "x_"}],
                           "]"
                          }
                         ],
                         "/;",
                         RowBox[{"g", "=!=", "x"}]
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         RowBox[{"dfunc", "[", RowBox[{"f", ",", "g"}], "]"}],
                         RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}]
                        }
                       ]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[
                            {
                             RowBox[{"f_", "[", RowBox[{"g_", ",", "c_"}], "]"}],
                             ",",
                             "x_"
                            }
                           ],
                           "]"
                          }
                         ],
                         "/;",
                         RowBox[
                          {
                           RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}],
                           "&&",
                           RowBox[{"g", "=!=", "x"}]
                          }
                         ]
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         RowBox[
                          {
                           "dfunc",
                           "[",
                           RowBox[
                            {
                             RowBox[
                              {RowBox[{"f", "[", RowBox[{"#", ",", "c"}], "]"}], "&"}
                             ],
                             ",",
                             "g"
                            }
                           ],
                           "]"
                          }
                         ],
                         RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}]
                        }
                       ]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[
                            {
                             RowBox[{"f_", "[", RowBox[{"c_", ",", "g_"}], "]"}],
                             ",",
                             "x_"
                            }
                           ],
                           "]"
                          }
                         ],
                         "/;",
                         RowBox[
                          {
                           RowBox[{"FreeQ", "[", RowBox[{"c", ",", "x"}], "]"}],
                           "&&",
                           RowBox[{"g", "=!=", "x"}]
                          }
                         ]
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         RowBox[
                          {
                           "dfunc",
                           "[",
                           RowBox[
                            {
                             RowBox[
                              {RowBox[{"f", "[", RowBox[{"c", ",", "#"}], "]"}], "&"}
                             ],
                             ",",
                             "g"
                            }
                           ],
                           "]"
                          }
                         ],
                         RowBox[{"d", "[", RowBox[{"g", ",", "x"}], "]"}]
                        }
                       ]
                      }
                     ]
                    }
                   ],
                   "\[IndentingNewLine]",
                   "}"
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[2]:="
           ],
           Cell["\:66ff\:6362\:89c4\:5219", "Text"],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "substRules",
                 "=",
                 RowBox[
                  {
                   RowBox[
                    {
                     RowBox[{"dfunc", "[", RowBox[{"f_", ",", "g_"}], "]"}],
                     "\[RuleDelayed]",
                     RowBox[
                      {
                       "d",
                       "[",
                       RowBox[{RowBox[{"f", "[", "u", "]"}], ",", "u"}],
                       "]"
                      }
                     ]
                    }
                   ],
                   "/.",
                   RowBox[{"{", RowBox[{"u", "\[Rule]", "g"}], "}"}]
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[4]:="
           ],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "substRules",
                 "=",
                 RowBox[
                  {
                   RowBox[{"dfunc", "[", RowBox[{"f_", ",", "g_"}], "]"}],
                   "\[RuleDelayed]",
                   RowBox[
                    {
                     "Module",
                     "[",
                     RowBox[
                      {
                       RowBox[{"{", "u", "}"}],
                       ",",
                       RowBox[
                        {
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[{RowBox[{"f", "[", "u", "]"}], ",", "u"}],
                           "]"
                          }
                         ],
                         "/.",
                         RowBox[{"{", RowBox[{"u", "\[Rule]", "g"}], "}"}]
                        }
                       ]
                      }
                     ],
                     "]"
                    }
                   ]
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[5]:="
           ],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "substRules",
                 "=",
                 RowBox[
                  {
                   RowBox[{"dfunc", "[", RowBox[{"f_", ",", "g_"}], "]"}],
                   "\[RuleDelayed]",
                   RowBox[
                    {
                     "Module",
                     "[",
                     RowBox[
                      {
                       RowBox[{"{", "u", "}"}],
                       ",",
                       RowBox[
                        {
                         RowBox[
                          {
                           "dEval",
                           "[",
                           RowBox[{RowBox[{"f", "[", "u", "]"}], ",", "u"}],
                           "]"
                          }
                         ],
                         "/.",
                         RowBox[{"{", RowBox[{"u", "\[Rule]", "g"}], "}"}]
                        }
                       ]
                      }
                     ],
                     "]"
                    }
                   ]
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[3]:="
           ],
           Cell["\:51fd\:6570\:89c4\:5219", "Text"],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "functionRules",
                 "=",
                 RowBox[
                  {
                   "{",
                   "\[IndentingNewLine]",
                   RowBox[
                    {
                     RowBox[
                      {
                       RowBox[
                        {
                         "HoldPattern",
                         "[",
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[
                            {
                             RowBox[
                              {
                               "IgnoringInactive",
                               "[",
                               RowBox[{"Exp", "[", "x_", "]"}],
                               "]"
                              }
                             ],
                             ",",
                             "x_"
                            }
                           ],
                           "]"
                          }
                         ],
                         "]"
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[{"Exp", "[", "x", "]"}]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         "HoldPattern",
                         "[",
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[
                            {
                             RowBox[
                              {
                               "IgnoringInactive",
                               "[",
                               RowBox[{"Log", "[", "x_", "]"}],
                               "]"
                              }
                             ],
                             ",",
                             "x_"
                            }
                           ],
                           "]"
                          }
                         ],
                         "]"
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[{"1", "/", "x"}]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         "HoldPattern",
                         "[",
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[
                            {
                             RowBox[
                              {
                               "IgnoringInactive",
                               "[",
                               RowBox[{"Sin", "[", "x_", "]"}],
                               "]"
                              }
                             ],
                             ",",
                             "x_"
                            }
                           ],
                           "]"
                          }
                         ],
                         "]"
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[{"Cos", "[", "x", "]"}]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         "HoldPattern",
                         "[",
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[
                            {
                             RowBox[
                              {
                               "IgnoringInactive",
                               "[",
                               RowBox[{"Cos", "[", "x_", "]"}],
                               "]"
                              }
                             ],
                             ",",
                             "x_"
                            }
                           ],
                           "]"
                          }
                         ],
                         "]"
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[{"-", RowBox[{"Sin", "[", "x", "]"}]}]
                      }
                     ]
                    }
                   ],
                   "\[IndentingNewLine]",
                   "}"
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[4]:="
           ],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "functionRules",
                 "=",
                 RowBox[
                  {
                   RowBox[
                    {
                     "Table",
                     "[",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[
                          {
                           "With",
                           "[",
                           RowBox[
                            {
                             RowBox[{"{", RowBox[{"f", "=", "f"}], "}"}],
                             ",",
                             RowBox[
                              {
                               "HoldPattern",
                               "@",
                               RowBox[
                                {
                                 "d",
                                 "[",
                                 RowBox[
                                  {
                                   RowBox[
                                    {"IgnoringInactive", "@", RowBox[{"f", "[", "x_", "]"}]}
                                   ],
                                   ",",
                                   "x_"
                                  }
                                 ],
                                 "]"
                                }
                               ]
                              }
                             ]
                            }
                           ],
                           "]"
                          }
                         ],
                         "\[Rule]",
                         RowBox[
                          {
                           "D",
                           "[",
                           RowBox[{RowBox[{"f", "[", "x", "]"}], ",", "x"}],
                           "]"
                          }
                         ]
                        }
                       ],
                       ",",
                       "\[IndentingNewLine]",
                       RowBox[
                        {
                         "{",
                         RowBox[
                          {
                           "f",
                           ",",
                           "\[IndentingNewLine]",
                           RowBox[
                            {
                             "{",
                             RowBox[
                              {
                               "Sqrt",
                               ",",
                               "CubeRoot",
                               ",",
                               "RealAbs",
                               ",",
                               "\[IndentingNewLine]",
                               "Exp",
                               ",",
                               "Log",
                               ",",
                               "Log2",
                               ",",
                               "Log10",
                               ",",
                               "\[IndentingNewLine]",
                               "Sin",
                               ",",
                               "Cos",
                               ",",
                               "Tan",
                               ",",
                               "Cot",
                               ",",
                               "Sec",
                               ",",
                               "Csc",
                               ",",
                               "\[IndentingNewLine]",
                               "ArcSin",
                               ",",
                               "ArcCos",
                               ",",
                               "ArcTan",
                               ",",
                               "ArcCot",
                               ",",
                               "ArcSec",
                               ",",
                               "ArcCsc",
                               ",",
                               "\[IndentingNewLine]",
                               "Sinh",
                               ",",
                               "Cosh",
                               ",",
                               "Tanh",
                               ",",
                               "Coth",
                               ",",
                               "Sech",
                               ",",
                               "Csch",
                               ",",
                               "\[IndentingNewLine]",
                               "ArcSinh",
                               ",",
                               "ArcCosh",
                               ",",
                               "ArcTanh",
                               ",",
                               "ArcCoth",
                               ",",
                               "ArcSech",
                               ",",
                               "ArcCsch"
                              }
                             ],
                             "\[IndentingNewLine]",
                             "}"
                            }
                           ]
                          }
                         ],
                         "\[IndentingNewLine]",
                         "}"
                        }
                       ]
                      }
                     ],
                     "]"
                    }
                   ],
                   "/.",
                   RowBox[
                    {"{", RowBox[{"Rule", "\[Rule]", "RuleDelayed"}], "}"}
                   ]
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input"
           ],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "functionExtRules",
                 "=",
                 RowBox[
                  {
                   "{",
                   "\[IndentingNewLine]",
                   RowBox[
                    {
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[
                          {
                           "HoldPattern",
                           "@",
                           RowBox[
                            {
                             "d",
                             "[",
                             RowBox[{RowBox[{"x_", "^", "a_."}], ",", "x_"}],
                             "]"
                            }
                           ]
                          }
                         ],
                         "/;",
                         RowBox[{"FreeQ", "[", RowBox[{"a", ",", "x"}], "]"}]
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         "a",
                         " ",
                         RowBox[
                          {"x", "^", RowBox[{"(", RowBox[{"a", "-", "1"}], ")"}]}
                         ]
                        }
                       ]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[
                          {
                           "HoldPattern",
                           "@",
                           RowBox[
                            {
                             "d",
                             "[",
                             RowBox[{RowBox[{"a_", "^", "x_"}], ",", "x_"}],
                             "]"
                            }
                           ]
                          }
                         ],
                         "/;",
                         RowBox[{"FreeQ", "[", RowBox[{"a", ",", "x"}], "]"}]
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         RowBox[{"a", "^", "x"}],
                         " ",
                         RowBox[{"Log", "[", "a", "]"}]
                        }
                       ]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[
                          {
                           "HoldPattern",
                           "@",
                           RowBox[
                            {
                             "d",
                             "[",
                             RowBox[
                              {
                               RowBox[
                                {
                                 "IgnoringInactive",
                                 "@",
                                 RowBox[{"Surd", "[", RowBox[{"x_", ",", "n_"}], "]"}]
                                }
                               ],
                               ",",
                               "x_"
                              }
                             ],
                             "]"
                            }
                           ]
                          }
                         ],
                         "/;",
                         RowBox[{"FreeQ", "[", RowBox[{"n", ",", "x"}], "]"}]
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         "1",
                         "/",
                         RowBox[
                          {
                           "(",
                           RowBox[
                            {
                             "n",
                             " ",
                             RowBox[
                              {
                               RowBox[{"Surd", "[", RowBox[{"x", ",", "n"}], "]"}],
                               "^",
                               RowBox[{"(", RowBox[{"n", "-", "1"}], ")"}]
                              }
                             ]
                            }
                           ],
                           ")"
                          }
                         ]
                        }
                       ]
                      }
                     ]
                    }
                   ],
                   "\[IndentingNewLine]",
                   "}"
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[6]:="
           ],
           Cell["\:53d8\:5f62\:89c4\:5219", "Text"],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "transferRules",
                 "=",
                 RowBox[
                  {
                   "{",
                   "\[IndentingNewLine]",
                   RowBox[
                    {
                     RowBox[
                      {
                       RowBox[
                        {
                         RowBox[
                          {
                           "HoldPattern",
                           "@",
                           RowBox[
                            {
                             "d",
                             "[",
                             RowBox[
                              {
                               RowBox[
                                {"IgnoringInactive", "[", RowBox[{"f_", "^", "g_"}], "]"}
                               ],
                               ",",
                               "x_"
                              }
                             ],
                             "]"
                            }
                           ]
                          }
                         ],
                         "/;",
                         RowBox[
                          {
                           "!",
                           RowBox[
                            {
                             "(",
                             RowBox[
                              {
                               RowBox[{"FreeQ", "[", RowBox[{"f", ",", "x"}], "]"}],
                               "||",
                               RowBox[{"FreeQ", "[", RowBox[{"g", ",", "x"}], "]"}]
                              }
                             ],
                             ")"
                            }
                           ]
                          }
                         ]
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         "d",
                         "[",
                         RowBox[
                          {
                           RowBox[
                            {
                             RowBox[{"Inactive", "[", "Exp", "]"}],
                             "[",
                             RowBox[{RowBox[{"Log", "[", "f", "]"}], "g"}],
                             "]"
                            }
                           ],
                           ",",
                           "x"
                          }
                         ],
                         "]"
                        }
                       ]
                      }
                     ],
                     ",",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       RowBox[
                        {
                         "HoldPattern",
                         "@",
                         RowBox[
                          {
                           "d",
                           "[",
                           RowBox[
                            {
                             RowBox[
                              {
                               "IgnoringInactive",
                               "@",
                               RowBox[{"Log", "[", RowBox[{"f_", ",", "g_"}], "]"}]
                              }
                             ],
                             ",",
                             "x_"
                            }
                           ],
                           "]"
                          }
                         ]
                        }
                       ],
                       "\[RuleDelayed]",
                       RowBox[
                        {
                         "d",
                         "[",
                         RowBox[
                          {
                           RowBox[
                            {
                             RowBox[{"Log", "[", "g", "]"}],
                             "/",
                             RowBox[{"Log", "[", "f", "]"}]
                            }
                           ],
                           ",",
                           "x"
                          }
                         ],
                         "]"
                        }
                       ]
                      }
                     ]
                    }
                   ],
                   "\[IndentingNewLine]",
                   "}"
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[7]:="
           ],
           Cell["\:6574\:5408\:5168\:90e8\:89c4\:5219", "Text"],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "allRules",
                 "=",
                 RowBox[
                  {
                   "Flatten",
                   "@",
                   RowBox[
                    {
                     "{",
                     "\[IndentingNewLine]",
                     RowBox[
                      {
                       "transferRules",
                       ",",
                       "\[IndentingNewLine]",
                       "baseRules",
                       ",",
                       "\[IndentingNewLine]",
                       "functionRules",
                       ",",
                       "\[IndentingNewLine]",
                       "functionExtRules",
                       ",",
                       "\[IndentingNewLine]",
                       "substRules",
                       ",",
                       "\[IndentingNewLine]",
                       "higherRules"
                      }
                     ],
                     "\[IndentingNewLine]",
                     "}"
                    }
                   ]
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[13]:="
           ],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[{"dEval", "[", RowBox[{"f_", ",", "x_"}], "]"}],
               ":=",
               RowBox[
                {
                 RowBox[{"d", "[", RowBox[{"f", ",", "x"}], "]"}],
                 "//.",
                 "allRules"
                }
               ]
              }
             ]
            ],
            "Input",
            CellLabel -> "In[9]:="
           ],
           Cell["\:6d4b\:8bd5", "Text"],
           Cell[
            CellGroupData[
             {
              Cell[
               BoxData[
                RowBox[
                 {
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[{"(", RowBox[{"dEval", "\[Equal]", "D"}], ")"}],
                      "[",
                      RowBox[
                       {
                        RowBox[
                         {
                          RowBox[
                           {
                            RowBox[
                             {
                              "(",
                              RowBox[
                               {
                                RowBox[{"x", "^", RowBox[{"Sin", "[", "x", "]"}]}],
                                "+",
                                RowBox[{"3", "x"}],
                                "+",
                                RowBox[{"ArcTan", "[", "x", "]"}]
                               }
                              ],
                              ")"
                             }
                            ],
                            "^",
                            "2"
                           }
                          ],
                          "/",
                          RowBox[
                           {
                            "(",
                            RowBox[
                             {
                              RowBox[{"x", "^", "4"}],
                              "-",
                              RowBox[
                               {
                                "3",
                                RowBox[
                                 {
                                  "Surd",
                                  "[",
                                  RowBox[{RowBox[{"x", "^", "5"}], ",", "3"}],
                                  "]"
                                 }
                                ],
                                RowBox[{"RealAbs", "@", RowBox[{"Log", "[", "x", "]"}]}]
                               }
                              ],
                              "+",
                              "2"
                             }
                            ],
                            ")"
                           }
                          ]
                         }
                        ],
                        ",",
                        "x"
                       }
                      ],
                      "]"
                     }
                    ],
                    "//",
                    "Through"
                   }
                  ],
                  "//",
                  "Simplify"
                 }
                ]
               ],
               "Input",
               CellLabel -> "In[10]:="
              ],
              Cell[BoxData["True"], "Output", CellLabel -> "Out[10]="]
             },
             Open
            ]
           ],
           Cell[
            CellGroupData[
             {
              Cell[
               BoxData[
                RowBox[
                 {
                  "dEval",
                  "[",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[{"Erf", "[", RowBox[{"Sin", "[", "x", "]"}], "]"}],
                      "^",
                      "2"
                     }
                    ],
                    ",",
                    "x"
                   }
                  ],
                  "]"
                 }
                ]
               ],
               "Input",
               CellLabel -> "In[11]:="
              ],
              Cell[
               BoxData[
                RowBox[
                 {
                  "2",
                  " ",
                  RowBox[{"Cos", "[", "x", "]"}],
                  " ",
                  RowBox[
                   {
                    "d",
                    "[",
                    RowBox[
                     {
                      RowBox[{"Erf", "[", RowBox[{"Sin", "[", "x", "]"}], "]"}],
                      ",",
                      RowBox[{"Sin", "[", "x", "]"}]
                     }
                    ],
                    "]"
                   }
                  ],
                  " ",
                  RowBox[{"Erf", "[", RowBox[{"Sin", "[", "x", "]"}], "]"}]
                 }
                ]
               ],
               "Output",
               CellLabel -> "Out[11]="
              ]
             },
             Open
            ]
           ],
           Cell["\:5065\:58ee\:6027", "Text"],
           Cell[
            BoxData[
             RowBox[
              {
               RowBox[
                {
                 "substRules",
                 "=",
                 RowBox[
                  {
                   RowBox[{"dfunc", "[", RowBox[{"f_", ",", "g_"}], "]"}],
                   "\[RuleDelayed]",
                   RowBox[
                    {
                     "Module",
                     "[",
                     RowBox[
                      {
                       RowBox[{"{", "u", "}"}],
                       ",",
                       RowBox[
                        {
                         "With",
                         "[",
                         RowBox[
                          {
                           RowBox[
                            {
                             "{",
                             RowBox[
                              {
                               "df",
                               "=",
                               RowBox[
                                {
                                 "dEval",
                                 "[",
                                 RowBox[{RowBox[{"f", "[", "u", "]"}], ",", "u"}],
                                 "]"
                                }
                               ]
                              }
                             ],
                             "}"
                            }
                           ],
                           ",",
                           RowBox[
                            {
                             RowBox[
                              {
                               "(",
                               RowBox[
                                {
                                 "df",
                                 "/.",
                                 RowBox[{"{", RowBox[{"u", "\[Rule]", "g"}], "}"}]
                                }
                               ],
                               ")"
                              }
                             ],
                             "/;",
                             RowBox[
                              {
                               "FreeQ",
                               "[",
                               RowBox[{"df", ",", RowBox[{"_d", "|", "_dfunc"}]}],
                               "]"
                              }
                             ]
                            }
                           ]
                          }
                         ],
                         "]"
                        }
                       ]
                      }
                     ],
                     "]"
                    }
                   ]
                  }
                 ]
                }
               ],
               ";"
              }
             ]
            ],
            "Input",
            CellLabel -> "In[12]:="
           ],
           Cell[
            CellGroupData[
             {
              Cell[
               BoxData[
                RowBox[
                 {
                  "dEval",
                  "[",
                  RowBox[
                   {
                    RowBox[
                     {
                      RowBox[{"Erf", "[", RowBox[{"Sin", "[", "x", "]"}], "]"}],
                      "^",
                      "2"
                     }
                    ],
                    ",",
                    "x"
                   }
                  ],
                  "]"
                 }
                ]
               ],
               "Input",
               CellLabel -> "In[14]:="
              ],
              Cell[
               BoxData[
                RowBox[
                 {
                  "2",
                  " ",
                  RowBox[{"Cos", "[", "x", "]"}],
                  " ",
                  RowBox[
                   {
                    "dfunc",
                    "[",
                    RowBox[{"Erf", ",", RowBox[{"Sin", "[", "x", "]"}]}],
                    "]"
                   }
                  ],
                  " ",
                  RowBox[{"Erf", "[", RowBox[{"Sin", "[", "x", "]"}], "]"}]
                 }
                ]
               ],
               "Output",
               CellLabel -> "Out[14]="
              ]
             },
             Open
            ]
           ]
          },
          Open
         ]
        ]
       },
       Open
      ]
     ]
    },
    Open
   ]
  ]
 },
 StyleDefinitions -> "Default.nb"
]